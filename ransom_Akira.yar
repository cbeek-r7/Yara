rule ransom_Akira
{

meta:
author = "Christiaan Beek at rapid7 dot com"
        date = "2023-06-21"
        version = "1"
        description = "rule to detect Akira ransomware samples"
  strings:
    $x = "akiral2iz6a7qgd3ayp3l6yub7xx2uep76idk3u2kollpj5z3z636bad.onion."
    $1 = {0ABE0C990608F502306E08882029030844224E08F502106E08A504046408ED0304AE2622223C08C628290308442A6E08ED0304AE2E222A7608ED0304AE3622323C08A638290308443A6E08ED0304AE3E223A7608ED0304AE1622123C08A018290308441A6E08ED0304AE1E221A}
    $2 = {A17E7F8C0960FFFFFFC4A17E6F4C0A80C4A17E7F4C0980C4A17E6F4C0AA0C4A17E7F4C09A0C4A17E6F4C0AC0C4A17E7F4C09C0C4A17E7F6C01E0C5FE7F00C5F877C36690C5FE6F0AC5FE6F5220C5FE6F5A40C5FE6F6260C5FDE709C5FDE75120C5FDE75940C5FDE76160C5FE6F8A80}
    $3 = {049441049641049841049A41049C41049E4104A08104A28104A44104A64104A84104AA4104AC4104AE4104B04104B24104B44104B64104B84104BA4104BC4104BE4104C04104C24104C4C104C64104C84104CA4104CC}
    $4 = {FFFFC4A17E6F8C0A60FFFFFFC4A17DE78C0960FFFFFFC4A17E6F4C0A80C4A17DE74C0980C4A17E6F4C0AA0C4A17DE74C09A0C4A17E6F4C0AC0C4A17DE74C09C0C4A17E7F6C01E0C5FE7F000FAEF8C5F877C36666}
    $5 = {6502E06902E06D023102710269027502E07902E07D0231028102E08502E08902E08D02E09102E09502E09902E09D02E0A102E0A502E0A902E0AD02600000111A07001A7479001A347800}
    $6 = {044403F9036C24144503F24533DE33F5C1C6104133DF4403CE41C1C3104503EBC1C31003D34133FCC1C710418BC54133C24403C7C1C00C4403F04533DE41C1C3084503EB458BD5}
  condition:
    ( uint16(0) == 0x5a4d and filesize < 500KB and ($x) ) or ( all of them )
    }
